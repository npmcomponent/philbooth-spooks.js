(function(){"use strict";function n(n){var u,i=n.archetype,s=n.spook||{},c=n.chains||{},f=n.results||{};if(o(i)&&r(i))throw Error("Invalid archetype");if(o(n.log))throw Error("Invalid log");for(u in i)i.hasOwnProperty(u)&&t(i[u])&&(s[u]=e({name:u,log:n.log,chain:c[u],result:f[u]}));return s}function o(n){return"object"!=typeof n||null===n}function r(n){return t(n)===!1}function t(n){return"function"==typeof n}function e(n){var o=n.name,r=n.chain,t=n.log,e=n.result;if("string"!=typeof o)throw Error("Invalid function name");return u(t,o,{counts:0,args:[],these:[]}),function(){return c(o,t,arguments,this),r===!0?this:e}}function u(n,o,r){var t;for(t in r)r.hasOwnProperty(t)&&i(n,t,o,r[t])}function i(n,o,r,t){s(n,o,{}),s(n[o],r,t)}function s(n,o,r){n[o]===void 0&&(n[o]=r)}function c(n,o,r,t){o.counts[n]+=1,o.args[n].push(r),o.these[n].push(t)}var f={obj:n,fn:e};module&&module.exports?module.exports=f:window.spooks=f})();